<link href="css/github-buttons.css" rel="stylesheet">
<script src="http://code.jquery.com/jquery-1.7.min.js"></script>
<script type="text/javascript">
  // Read a page's GET URL variables and return them as an associative array.
  // Source: http://jquery-howto.blogspot.com/2009/09/get-url-parameters-values-with-jquery.html
  function getUrlVars() {
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++) {
      hash = hashes[i].split('=');
      vars.push(hash[0]);
      vars[hash[0]] = hash[1];
    }
    return vars;
  }
  var user = getUrlVars()['user'];
  var repo = getUrlVars()['repo'];
  var type = getUrlVars()['type'];

  // Le jQuery
  $(document).ready(function($){
    // Add commas
    function addCommas(nStr) {
      nStr += '';
      x = nStr.split('.');
      x1 = x[0];
      x2 = x.length > 1 ? '.' + x[1] : '';
      var rgx = /(\d+)(\d{3})/;
      while (rgx.test(x1)) {
        x1 = x1.replace(rgx, '$1' + ',' + '$2');
      }
      return x1 + x2;
    }
    // GitHub data
    $.ajax("https://api.github.com/repos/"+user+"/"+repo+"", {
      dataType: "jsonp",
      success: function (obj) {
        $('.github-watchers .gh-count').html(addCommas(obj['data']['watchers']));
        $('.github-forks .gh-count').html(addCommas(obj['data']['forks']));
      }
    });

    if (type == 'watchers') {
      $('.github-watchers').show();
    } else {
      $('.github-forks').show();
    }
  });
</script>

<span class="github-btn github-watchers">
  <a href="https://github.com/twitter/bootstrap" class="gh-btn">
    <img class="gh-ico" src="img/github-16px.png">
    Watch
  </a>
  <span class="gh-count"></span>
</span>
<span class="github-btn github-forks">
  <a href="https://github.com/twitter/bootstrap" class="gh-btn">
    <img class="gh-ico" src="img/github-16px.png">
    Fork
  </a>
  <span class="gh-count"></span>
</span>